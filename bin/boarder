#!/usr/bin/env node

const inquirer = require('inquirer');
const chalk = require('chalk');
const shelljs = require('shelljs');

const baseConfig = {
  projectName: 'webpack-demo'
};

const argv = require('yargs')
  .alias('h', 'help')
  .alias('-v', '--version')
  .alias('-V', '--version')
  .usage('Usage: $0 init')
  .command(
    'init',
    chalk.underline('init base on webpack demo'),
    yargs => {

    },
    argv => {
      init()
    }
  )
  .example('$0 init')
  .demandCommand(1, chalk.magenta('You need init command before moving on'))
  .argv;

async function init() {
  const config = {};
  inquirer.prompt([{
    type: 'input',
    name: 'projectName',
    default: 'webpack-demo',
    message: 'project name?',
  }]).then(answers => {
    Object.assign(baseConfig, answers)
    create(baseConfig)
  });

}

async function create(config) {
  console.log('create', config)
  const npmAddr = shelljs.exec('npm config get prefix', {
    silent: true
  }).stdout.replace(/\n/g, '');
  shelljs.mkdir('-p', config.projectName)
  shelljs.cp('-r', [npmAddr + '/lib/node_modules/boarder/template/*'], config.projectName)
}